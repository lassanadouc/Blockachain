<html>
<head>
    <script src= "node_modules/web3/dist/web3.js" type="text/javascript" >
    </script>
    <script src= "node_modules/truffle-contract/dist/truffle-contract.js" type="text/javascript" >
    </script>
    <script type="text/javascript">
    function mafonction(index){
      var web3;
if (typeof web3 !== 'undefined') {
web3 = new Web3(web3.currentProvider);
} else {
// set the provider you want from Web3.providers
web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:7545"));
}

      var EthereumSession = web3.eth.contract([
  {
    "constant": true,
    "inputs": [],
    "name": "allowed_account",
    "outputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "names_A_to_F",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "internalType": "string",
        "name": "_id",
        "type": "string"
      }
    ],
    "name": "setName",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getindex",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "internalType": "uint256",
        "name": "_i",
        "type": "uint256"
      }
    ],
    "name": "getLastName",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }
] );
      var ethereumSessionInstance = EthereumSession.at("0xCAa7411A544f717059e9b19656818aF7cF917B2b");
      web3.eth.defaultAccount = web3.eth.accounts[0];
      resulta0 = null;
      resulta1 = null;
       
      
      string1= 'nameoffile11'
      string2= 'hashoffile11'
      stringtosave = string1 + '.'+ string2
      
      //ethereumSessionInstance.setName(stringtosave);
      resulta1 = ethereumSessionInstance.getindex();
    
      resulta0 = ethereumSessionInstance.getLastName(index);

      words= resulta0.split('.');
        string3 = 'nameoffile10';
      stringtocomparetohash = "hashoffile10";
      
      

      if (resulta0.indexOf(string3) !== -1 && stringtocomparetohash == words[1] ) {
          console.log("Fichier integre")
          
        }
        else {
          console.log("fichier corompu")
        }
        
        
    
      //resulta1 = ethereumSessionInstance.getLastName();
      console.log(resulta1.toString()) ;
      //console.log(stringtosave)

      //Truffle-Contract
/*
var provider = new Web3.providers.HttpProvider("http://localhost:7545");

var EthereumSessionTruffle = TruffleContract({abi: [
  {
    "inputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  },
  {
    "constant": true,
    "inputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "names_A_to_F",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getAliceName",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getBobName",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getEveName",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getChuckName",
    "outputs": [
      {
        "internalType": "string",
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }
]});
EthereumSessionTruffle.setProvider(provider);
var esTruffleInstance = null;
EthereumSessionTruffle.at("0x992A20AFA125B0019fA82A3Ba797d6A4CA7DB9cE").then(instance => {
esTruffleInstance = instance;
  console.log(instance);
  web3.eth.defaultAccount = web3.eth.accounts[0];
  
return instance.setTheInt(4545);
}).then(function() {
return esTruffleInstance.getTheInt();
}).then(result => { console.log(result);});
*/}
</script>

</head>
<body>
  <p>
    <h1> liste des archives</h1>
    <ul> 
    <li>nameoffile  <button id="VDM" onclick="mafonction(0);">vérifier les métadonnées </button>  </li> 
    <li>nameoffile1 <button id="VDM" onclick="mafonction(1);">vérifier les métadonnées </button> </li>
    <li>nameoffile2 <button id="VDM" onclick="mafonction(2);">vérifier les métadonnées </button> </li>
    <li>nameoffile3 <button id="VDM" onclick="mafonction(3);">vérifier les métadonnées </button> </li>
    <li>nameoffile4 <button id="VDM" onclick="mafonction(4);">vérifier les métadonnées </button> </li>
    <li>nameoffile5 <button id="VDM" onclick="mafonction(5);">vérifier les métadonnées </button> </li>
    <li>nameoffile6 <button id="VDM" onclick="mafonction(6);">vérifier les métadonnées </button> </li>
    <li>nameoffile7 <button id="VDM" onclick="mafonction(7);">vérifier les métadonnées </button> </li>
    <li>nameoffile8 <button id="VDM" onclick="mafonction(8);">vérifier les métadonnées </button> </li>
    <li>nameoffile9 <button id="VDM" onclick="mafonction(9);">vérifier les métadonnées </button> </li>
    <li>nameoffile10 <button id="VDM" onclick="mafonction(10);">vérifier les métadonnées </button> </li>
    <li>nameoffile11 <button id="VDM" onclick="mafonction(11);">vérifier les métadonnées </button> </li>
    </ul>
    </p>
  </body>
  </html>
  <script type="text/javascript">
    // Ici on apelle la fonction
   mafonction(10)
    </script>
  
    
    </body>
    </html>

